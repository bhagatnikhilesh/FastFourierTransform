
% clc
% clear all
% close all
% 
% x = [0 i zeros(1,14)];
% n = 1:1:16;

% Cosine
% x = [1.0000 + 0.0000i
%    0.9239 - 0.3827i
%    0.7071 - 0.7071i
%    0.3827 - 0.9239i
%    0.0000 - 1.0000i
%   -0.3827 - 0.9239i
%   -0.7071 - 0.7071i
%   -0.9239 - 0.3827i
%   -1.0000 + 0.0000i
%   -0.9239 + 0.3827i
%   -0.7071 + 0.7071i
%   -0.3827 + 0.9239i
%    0.0000 + 1.0000i
%    0.3827 + 0.9239i
%    0.7071 + 0.7071i
%    0.9239 + 0.3827i];

% Sine
% x = [0.0000 + 1.0000i
%    0.3827 + 0.9239i
%    0.7071 + 0.7071i
%    0.9239 + 0.3827i
%    1.0000 + 0.0000i
%    0.9239 - 0.3827i
%    0.7071 - 0.7071i
%    0.3827 - 0.9239i
%    0.0000 - 1.0000i
%   -0.3827 - 0.9239i
%   -0.7071 - 0.7071i
%   -0.9239 - 0.3827i
%   -1.0000 + 0.0000i
%   -0.9239 + 0.3827i
%   -0.7071 + 0.7071i
%   -0.3827 + 0.9239i];


% x = input('Enter the 16-pt input sequence: ');
function Xk = wfta_16pt(x)
% u = 2*pi/16;
u = pi/8;
v = transpose(x);

% A = [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1;
%     1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1;
%     1 0 -1 0 1 0 -1 0 1 0 -1 0 1 0 -1 0;
%     1 0 0 0 -1 0 0 0 1 0 0 0 -1 0 0 0;
%     1 0 0 0 0 0 0 0 -1 0 0 0 0 0 0 0;
%     0 1 0 -1 0 -1 0 1 0 1 0 -1 0 -1 0 1;
%     0 0 1 0 0 0 -1 0 0 0 -1 0 0 0 1 0;
%     0 1 0 -1 0 1 0 -1 0 -1 0 1 0 -1 0 1;
%     0 1 0 0 0 0 0 -1 0 -1 0 0 0 0 0 1;
%     0 0 0 -1 0 1 0 0 0 0 0 1 0 -1 0 0;
%     0 -1 0 1 0 -1 0 1 0 -1 0 1 0 -1 0 1;
%     0 0 -1 0 0 0 1 0 0 0 -1 0 0 0 1 0;
%     0 0 0 0 1 0 0 0 0 0 0 0 -1 0 0 0;
%     0 1 0 1 0 -1 0 -1 0 1 0 1 0 -1 0 -1;
%     0 0 1 0 0 0 1 0 0 0 -1 0 0 0 -1 0;
%     0 1 0 1 0 1 0 1 0 -1 0 -1 0 -1 0 -1;
%     0 1 0 0 0 0 0 1 0 -1 0 0 0 0 0 -1;
%     0 0 0 1 0 1 0 0 0 0 0 -1 0 -1 0 0];

A = [1  0   1   0   1   0   1   0   1   0   1   0   1   0   1   0;
     0  1   0   1   0   1   0   1   0   1   0   1   0   1   0   1;
     1  0  -1   0   1   0  -1   0   1   0  -1   0   1   0  -1   0;
     0  1   0  -1   0   1   0  -1   0   1   0  -1   0   1   0  -1;
     1  0   0   0  -1   0   0   0   1   0   0   0  -1   0   0   0;
     0  0   1   0   0   0  -1   0   0   0   1   0   0   0  -1   0;
     0  1   0   1   0  -1   0  -1   0   1   0   1   0  -1   0  -1;
     0  1   0  -1   0  -1   0   1   0   1   0  -1   0  -1   0   1;
     1  0   0   0   0   0   0   0  -1   0   0   0   0   0   0   0;
     0  0   0   0   1   0   0   0   0   0   0   0  -1   0   0   0;
     0  0   1   0   0   0   1   0   0   0  -1   0   0   0  -1   0;
     0  0   1   0   0   0  -1   0   0   0  -1   0   0   0   1   0;
     0  1   0   0   0   0   0   1   0  -1   0   0   0   0   0  -1;
     0  0   0   1   0   1   0   0   0   0   0  -1   0  -1   0   0;
     0  1   0   1   0   1   0   1   0  -1   0  -1   0  -1   0  -1;
     0  1   0   0   0   0   0  -1   0  -1   0   0   0   0   0   1;
     0  0   0   1   0  -1   0   0   0   0   0  -1   0   1   0   0;
     0  1   0   1   0  -1   0  -1   0  -1   0  -1   0   1   0   1];

% C = [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 1 0 1 -1 1 0 0 0 j 0 j j j 0;
%     0 0 0 1 0 1 0 0 0 0 0 i 0 i 0 0 0 0;
%     0 0 0 0 1 0 -1 1 0 -1 0 0 -i 0 i i 0 -i;
%     0 0 1 0 0 0 0 0 0 0 i 0 0 0 0 0 0 0;
%     0 0 0 0 1 0 -1 -1 0 1 0 0 i 0 -i i 0 -i;
%     0 0 0 1 0 -1 0 0 0 0 0 -i 0 i 0 0 0 0;
%     0 0 0 0 1 0 1 1 -1 0 0 0 -i 0 -i i i 0;
%     0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
%     0 0 0 0 1 0 1 1 -1 0 0 0 i 0 i -i -i 0;
%     0 0 0 1 0 -1 0 0 0 0 0 i 0 -i 0 0 0 0;
%     0 0 0 0 1 0 -1 -1 0 1 0 0 -i 0 i -i 0 i;
%     0 0 1 0 0 0 0 0 0 0 -i 0 0 0 0 0 0 0;
%     0 0 0 0 1 0 -1 1 0 -1 0 0 i 0 -i -i 0 i;
%     0 0 0 1 0 1 0 0 0 0 0 -i 0 -i 0 0 0 0;
%     0 0 0 0 1 0 1 -1 1 0 0 0 -i 0 -i -i -i 0];

C = [1  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1  -1   1   1   1   0   1   1   0   1;
     0  0   0   0   1  -1   1   1   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1   1   1  -1   0   1   1   0   1   1;
     0  0   1  -1   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1  -1  -1  -1   0   1   1   0  -1  -1;
     0  0   0   0   1   1   1  -1   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1   1  -1   1   1   0   1  -1   0  -1;
     1 -1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1  -1   1   1  -1   0  -1  -1   0  -1;
     0  0   0   0   1  -1  -1  -1   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1   1   1  -1   0  -1  -1   0  -1  -1;
     0  0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1  -1  -1  -1   0  -1  -1   0   1   1;
     0  0   0   0   1   1  -1   1   0   0   0   0   0   0   0   0   0   0;
     0  0   0   0   0   0   0   0   1   1  -1   1  -1   0  -1   1   0   1];

% b(1) = 1;
% b(2) = 1;
% b(3) = 1;
% b(4) = 1;
% b(5) = 1;
% b(6) = cos(2*u);
% b(7) = cos(2*u);
% b(8) = cos(3*u);
% b(9) = cos(u) + cos(3*u);
% b(10) = -1*cos(u) + cos(3*u);
% b(11) = 1;
% b(12) = 1;
% b(13) = 1;
% b(14) = -1*(sin(2*u));
% b(15) = -1*(sin(2*u));
% b(16) = -1*(sin(3*u));
% b(17) = -1*sin(u) + sin(3*u);
% b(18) = -1*sin(u) - sin(3*u);

b(1) = 1;
b(2) = 1;
b(3) = 1;
b(5) = 1;
b(9) = 1;
b(4) = j;
b(6) = j;
b(10) = j;
b(7) = -j*sin(2*u);
b(11) = -j*sin(2*u);
b(8) = cos(2*u);
b(12) = cos(2*u);
b(13) = j*(-sin(u)+sin(3*u));
b(14) = j*(sin(u)+sin(3*u));
b(15) = -j*sin(3*u);
b(16) = cos(u) - cos(3*u);
b(17) = -cos(u) - cos(3*u);
b(18) = cos(3*u);

B = diag(b);

a = A*v;
r = B*a;
X = C*r;


Xk = X;

end


% disp(Xk);
% figure(1);
% stem(n,(Xk));
% grid on;
% 
% Xf = fft(x);
% figure(2);
% stem(n,(Xf));
% grid on;




















